{"openapi":"3.0.0","paths":{"/":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":""}}}},"/hello/{name}":{"get":{"operationId":"AppController_getHelloName","parameters":[{"name":"name","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}}}},"/health":{"get":{"operationId":"HealthController_check","parameters":[],"responses":{"200":{"description":"The Health Check is successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"ok"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}},"503":{"description":"The Health Check is not successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"error"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"},"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}}}}},"/auth/register":{"post":{"operationId":"AuthController_register","summary":"用户注册","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterDto"}}}},"responses":{"201":{"description":"用户注册成功，返回用户信息（不含密码）"},"400":{"description":"输入数据验证失败"},"409":{"description":"邮箱已被注册"}},"tags":["Auth"]}},"/auth/login":{"post":{"operationId":"AuthController_login","summary":"用户登录","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":"登录成功，返回 Access Token 和 Refresh Token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenDto"}}}},"400":{"description":"输入数据验证失败"},"401":{"description":"邮箱或密码错误"}},"tags":["Auth"]}},"/auth/refresh":{"post":{"operationId":"AuthController_refreshToken","summary":"刷新 Access Token","parameters":[],"responses":{"200":{"description":"Token 刷新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenDto"}}}},"401":{"description":"Refresh Token 无效或已过期"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/auth/me":{"get":{"operationId":"AuthController_getProfile","summary":"获取当前用户信息","parameters":[],"responses":{"200":{"description":"成功获取用户信息","content":{"application/json":{"schema":{"type":"object"}}}},"401":{"description":"未授权或 Token 无效"}},"tags":["Auth"],"security":[{"bearer":[]}]}},"/children":{"post":{"operationId":"ChildrenController_create","summary":"添加新的儿童信息","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChildDto"}}}},"responses":{"201":{"description":"儿童信息添加成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildResponseDto"}}}},"400":{"description":"输入数据验证失败"},"401":{"description":"未授权"}},"tags":["Children"],"security":[{"bearer":[]}]},"get":{"operationId":"ChildrenController_findAll","summary":"获取当前用户的所有儿童列表","parameters":[],"responses":{"200":{"description":"成功获取儿童列表","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ChildResponseDto"}}}}},"401":{"description":"未授权"}},"tags":["Children"],"security":[{"bearer":[]}]}},"/children/{id}":{"get":{"operationId":"ChildrenController_findOne","summary":"获取指定 ID 的儿童信息","parameters":[{"name":"id","required":true,"in":"path","description":"儿童的唯一标识符","schema":{"type":"number"}}],"responses":{"200":{"description":"成功获取儿童信息","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildResponseDto"}}}},"401":{"description":"未授权"},"403":{"description":"无权访问该儿童信息"},"404":{"description":"未找到指定 ID 的儿童信息"}},"tags":["Children"],"security":[{"bearer":[]}]},"patch":{"operationId":"ChildrenController_update","summary":"更新指定 ID 的儿童信息","parameters":[{"name":"id","required":true,"in":"path","description":"儿童的唯一标识符","schema":{"type":"number"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateChildDto"}}}},"responses":{"200":{"description":"儿童信息更新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildResponseDto"}}}},"400":{"description":"输入数据验证失败"},"401":{"description":"未授权"},"403":{"description":"无权修改该儿童信息"},"404":{"description":"未找到指定 ID 的儿童信息"}},"tags":["Children"],"security":[{"bearer":[]}]},"delete":{"operationId":"ChildrenController_remove","summary":"删除指定 ID 的儿童信息","parameters":[{"name":"id","required":true,"in":"path","description":"儿童的唯一标识符","schema":{"type":"number"}}],"responses":{"200":{"description":"儿童信息删除成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChildResponseDto"}}}},"401":{"description":"未授权"},"403":{"description":"无权删除该儿童信息"},"404":{"description":"未找到指定 ID 的儿童信息"}},"tags":["Children"],"security":[{"bearer":[]}]}},"/records":{"post":{"operationId":"RecordsController_create","summary":"创建日常记录","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateRecordDto"}}}},"responses":{"201":{"description":"记录创建成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordResponseDto"}}}},"400":{"description":"无效的请求数据"},"401":{"description":"未授权"},"403":{"description":"无权操作此儿童的记录"},"404":{"description":"儿童不存在"}},"tags":["日常记录"],"security":[{"bearer":[]}]}},"/records/child/{childId}":{"get":{"operationId":"RecordsController_findAllByChild","summary":"获取特定儿童的所有记录","parameters":[{"name":"childId","required":true,"in":"path","description":"儿童ID","schema":{"type":"number"}}],"responses":{"200":{"description":"成功获取记录列表","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RecordResponseDto"}}}}},"401":{"description":"未授权"},"403":{"description":"无权查看此儿童的记录"},"404":{"description":"儿童不存在"}},"tags":["日常记录"],"security":[{"bearer":[]}]}},"/records/{id}":{"get":{"operationId":"RecordsController_findOne","summary":"获取特定记录详情","parameters":[{"name":"id","required":true,"in":"path","description":"记录ID","schema":{"type":"number"}}],"responses":{"200":{"description":"成功获取记录详情","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordResponseDto"}}}},"401":{"description":"未授权"},"403":{"description":"无权查看此记录"},"404":{"description":"记录不存在"}},"tags":["日常记录"],"security":[{"bearer":[]}]},"patch":{"operationId":"RecordsController_update","summary":"更新特定记录","parameters":[{"name":"id","required":true,"in":"path","description":"记录ID","schema":{"type":"number"}}],"requestBody":{"required":true,"description":"更新记录数据","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateRecordDto"}}}},"responses":{"200":{"description":"记录更新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordResponseDto"}}}},"400":{"description":"无效的请求数据"},"401":{"description":"未授权"},"403":{"description":"无权更新此记录"},"404":{"description":"记录不存在"}},"tags":["日常记录"],"security":[{"bearer":[]}]},"delete":{"operationId":"RecordsController_remove","summary":"删除特定记录","parameters":[{"name":"id","required":true,"in":"path","description":"记录ID","schema":{"type":"number"}}],"responses":{"200":{"description":"记录删除成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordResponseDto"}}}},"401":{"description":"未授权"},"403":{"description":"无权删除此记录"},"404":{"description":"记录不存在"}},"tags":["日常记录"],"security":[{"bearer":[]}]}},"/ai/chat":{"post":{"operationId":"AIController_chat","summary":"发送聊天消息并获取AI回复","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequestDto"}}}},"responses":{"201":{"description":"AI回复成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponseDto"}}}}},"tags":["ai"],"security":[{"bearer":[]}]}},"/ai/suggestions":{"get":{"operationId":"AIController_getSuggestions","summary":"获取基于用户和孩子信息的问题建议","parameters":[{"name":"childId","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"获取建议成功","content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}}}},"tags":["ai"],"security":[{"bearer":[]}]}},"/vector/text-chunk":{"post":{"operationId":"VectorController_addTextChunk","summary":"添加文本块","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTextChunkDto"}}}},"responses":{"201":{"description":"文本块创建成功","content":{"application/json":{"schema":{"type":"number"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/text-chunks":{"post":{"operationId":"VectorController_addTextChunks","summary":"批量添加文本块","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTextChunksDto"}}}},"responses":{"201":{"description":"批量添加成功","content":{"application/json":{"schema":{"type":"number"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/search":{"post":{"operationId":"VectorController_searchSimilarTextChunks","summary":"搜索相似文本块","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchTextChunkDto"}}}},"responses":{"200":{"description":"搜索结果","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TextChunkResponseDto"}}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/text-chunk/{id}":{"get":{"operationId":"VectorController_getTextChunkById","summary":"获取文本块","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"number"}}],"responses":{"200":{"description":"文本块信息","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TextChunkResponseDto"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]},"put":{"operationId":"VectorController_updateTextChunk","summary":"更新文本块","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"number"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTextChunkDto"}}}},"responses":{"200":{"description":"更新结果","content":{"application/json":{"schema":{"type":"boolean"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]},"delete":{"operationId":"VectorController_deleteTextChunk","summary":"删除文本块","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"number"}}],"responses":{"200":{"description":"删除结果","content":{"application/json":{"schema":{"type":"boolean"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/source/{type}/{id}":{"get":{"operationId":"VectorController_getTextChunksBySource","summary":"获取来源文本块","parameters":[{"name":"type","required":true,"in":"path","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"number"}}],"responses":{"200":{"description":"文本块列表","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TextChunkResponseDto"}}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]},"delete":{"operationId":"VectorController_deleteTextChunksBySource","summary":"删除来源文本块","parameters":[{"name":"type","required":true,"in":"path","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"number"}}],"responses":{"200":{"description":"删除结果","content":{"application/json":{"schema":{"type":"number"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/child/{childId}":{"get":{"operationId":"VectorController_getTextChunksByChildId","summary":"获取儿童文本块","parameters":[{"name":"childId","required":true,"in":"path","schema":{"type":"number"}},{"name":"limit","required":true,"in":"query","schema":{"type":"number"}},{"name":"offset","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"文本块列表","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TextChunkResponseDto"}}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]},"delete":{"operationId":"VectorController_deleteTextChunksByChildId","summary":"删除儿童文本块","parameters":[{"name":"childId","required":true,"in":"path","schema":{"type":"number"}}],"responses":{"200":{"description":"删除结果","content":{"application/json":{"schema":{"type":"number"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/count":{"get":{"operationId":"VectorController_getTextChunksCount","summary":"获取文本块总数","parameters":[{"name":"childId","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"文本块总数","content":{"application/json":{"schema":{"type":"number"}}}}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/performance/insert":{"post":{"operationId":"VectorController_testInsertPerformance","summary":"性能测试：向量插入操作","parameters":[],"responses":{"200":{"description":"性能测试结果"}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/performance/search":{"post":{"operationId":"VectorController_testSearchPerformance","summary":"性能测试：向量查询操作","parameters":[],"responses":{"200":{"description":"性能测试结果"}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/vector/performance/batch-insert":{"post":{"operationId":"VectorController_testBatchInsertPerformance","summary":"性能测试：批量向量插入操作","parameters":[],"responses":{"200":{"description":"性能测试结果"}},"tags":["向量数据库"],"security":[{"bearer":[]}]}},"/chat/history":{"get":{"operationId":"ChatController_getChatHistory","summary":"获取用户的聊天历史","parameters":[{"name":"childId","required":true,"in":"query","schema":{"type":"number"}},{"name":"limit","required":true,"in":"query","schema":{"type":"number"}},{"name":"offset","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"获取历史成功"}},"tags":["chat"],"security":[{"bearer":[]}]}},"/chat/children/{childId}":{"get":{"operationId":"ChatController_getChildChats","summary":"获取特定孩子的聊天历史","parameters":[{"name":"childId","required":true,"in":"path","schema":{"type":"number"}},{"name":"limit","required":true,"in":"query","schema":{"type":"number"}},{"name":"offset","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"获取孩子聊天历史成功"}},"tags":["chat"],"security":[{"bearer":[]}]}},"/chat/suggestions":{"get":{"operationId":"ChatController_getSuggestions","summary":"获取基于用户和孩子信息的问题建议","parameters":[{"name":"childId","required":true,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"获取建议成功","content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}}}},"tags":["chat"],"security":[{"bearer":[]}]}},"/chat/{id}/feedback":{"put":{"operationId":"ChatController_provideFeedback","summary":"为聊天提供反馈（有用/无用）","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"number"}}],"responses":{"200":{"description":"提供反馈成功"}},"tags":["chat"],"security":[{"bearer":[]}]}},"/chat/feedback":{"post":{"operationId":"ChatController_saveFeedback","summary":"为聊天提供反馈（有用/无用）","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatFeedbackDto"}}}},"responses":{"200":{"description":"提供反馈成功"}},"tags":["chat"],"security":[{"bearer":[]}]}},"/chat/stream":{"get":{"operationId":"ChatController_chatStream","summary":"发送聊天消息并以SSE方式获取AI回复","parameters":[{"name":"message","required":true,"in":"query","schema":{"type":"string"}},{"name":"childId","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"聊天成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatStreamResponseDto"}}}}},"tags":["chat"],"security":[{"bearer":[]}]}},"/chat":{"post":{"operationId":"ChatController_chat","summary":"发送聊天消息并以SSE方式获取AI回复","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequestDto"}}}},"responses":{"200":{"description":"聊天成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatStreamResponseDto"}}}}},"tags":["chat"],"security":[{"bearer":[]}]}},"/chat/sync":{"post":{"operationId":"ChatController_chatSync","summary":"发送聊天消息并获取非流式AI回复","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequestDto"}}}},"responses":{"200":{"description":"聊天成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponseDto"}}}}},"tags":["chat"],"security":[{"bearer":[]}]}},"/preprocessing/child/{childId}":{"post":{"operationId":"PreprocessingController_processChildProfile","summary":"处理儿童信息","parameters":[{"name":"childId","required":true,"in":"path","description":"儿童ID","schema":{"type":"number"}}],"responses":{"200":{"description":"处理结果","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"}}}}}}},"tags":["数据预处理"],"security":[{"bearer":[]}]}},"/preprocessing/record/{recordId}":{"post":{"operationId":"PreprocessingController_processRecord","summary":"处理记录","parameters":[{"name":"recordId","required":true,"in":"path","description":"记录ID","schema":{"type":"number"}}],"responses":{"200":{"description":"处理结果","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"}}}}}}},"tags":["数据预处理"],"security":[{"bearer":[]}]}},"/preprocessing/records/batch/{childId}":{"post":{"operationId":"PreprocessingController_processRecordsBatch","summary":"批量处理记录","parameters":[{"name":"childId","required":true,"in":"path","description":"儿童ID","schema":{"type":"number"}},{"name":"limit","required":false,"in":"query","description":"处理记录数量限制","schema":{"type":"number"}},{"name":"fromDate","required":false,"in":"query","description":"开始日期 (ISO格式)","schema":{"type":"string"}}],"responses":{"200":{"description":"处理结果","content":{"application/json":{"schema":{"type":"object","properties":{"processed":{"type":"number"}}}}}}},"tags":["数据预处理"],"security":[{"bearer":[]}]}},"/preprocessing/chat/{chatHistoryId}":{"post":{"operationId":"PreprocessingController_processChatHistory","summary":"处理聊天历史","parameters":[{"name":"chatHistoryId","required":true,"in":"path","description":"聊天历史ID","schema":{"type":"number"}}],"responses":{"200":{"description":"处理结果","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"}}}}}}},"tags":["数据预处理"],"security":[{"bearer":[]}]}},"/preprocessing/rebuild/{childId}":{"post":{"operationId":"PreprocessingController_rebuildChildVectors","summary":"重建儿童向量数据","parameters":[{"name":"childId","required":true,"in":"path","description":"儿童ID","schema":{"type":"number"}}],"responses":{"200":{"description":"重建结果","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"profileProcessed":{"type":"boolean"},"recordsProcessed":{"type":"number"},"chatHistoriesProcessed":{"type":"number"}}}}}}},"tags":["数据预处理"],"security":[{"bearer":[]}]}}},"info":{"title":"Nestjs FTW","description":"The nestjs API description","version":"2.0","contact":{}},"tags":[],"servers":[],"components":{"schemas":{"RegisterDto":{"type":"object","properties":{"email":{"type":"string","description":"用户的邮箱地址","example":"test@example.com"},"password":{"type":"string","description":"用户密码，长度至少8位，包含大小写字母和数字","example":"Password123","minLength":8,"maxLength":50}},"required":["email","password"]},"LoginDto":{"type":"object","properties":{"email":{"type":"string","description":"用户的邮箱地址","example":"test@example.com"},"password":{"type":"string","description":"用户密码","example":"Password123"}},"required":["email","password"]},"TokenDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"JWT Access Token"},"refreshToken":{"type":"string","description":"JWT Refresh Token"}},"required":["accessToken","refreshToken"]},"CreateChildDto":{"type":"object","properties":{"nickname":{"type":"string","description":"孩子昵称","example":"宝宝"},"dateOfBirth":{"type":"string","description":"出生日期","example":"2023-01-15"},"gender":{"type":"string","description":"性别 (可选)","example":"male"},"allergyInfo":{"description":"过敏信息列表 (字符串数组)","example":["花生","海鲜"],"type":"array","items":{"type":"string"}},"moreInfo":{"type":"string","description":"更多信息 (可选)","example":"喜欢听音乐"}},"required":["nickname","dateOfBirth"]},"ChildResponseDto":{"type":"object","properties":{"id":{"type":"number","description":"儿童的唯一标识符","example":1},"nickname":{"type":"string","description":"儿童昵称","example":"宝宝"},"dateOfBirth":{"format":"date-time","type":"string","description":"出生日期 (YYYY-MM-DD)","example":"2023-01-15"},"gender":{"type":"string","description":"性别","example":"男"},"allergyInfo":{"description":"过敏信息列表 (字符串数组)","example":["花生","海鲜"],"type":"array","items":{"type":"string"}},"moreInfo":{"type":"string","description":"其他信息","example":"喜欢恐龙玩具"},"createdAt":{"format":"date-time","type":"string","description":"记录创建时间"},"updatedAt":{"format":"date-time","type":"string","description":"记录更新时间"}},"required":["id","nickname","dateOfBirth","createdAt","updatedAt"]},"UpdateChildDto":{"type":"object","properties":{"nickname":{"type":"string","description":"孩子昵称","example":"宝宝"},"dateOfBirth":{"type":"string","description":"出生日期","example":"2023-01-15"},"gender":{"type":"string","description":"性别 (可选)","example":"male"},"allergyInfo":{"description":"过敏信息列表 (字符串数组)","example":["花生","海鲜"],"type":"array","items":{"type":"string"}},"moreInfo":{"type":"string","description":"更多信息 (可选)","example":"喜欢听音乐"}}},"CreateRecordDto":{"type":"object","properties":{"childId":{"type":"number","description":"儿童ID","example":1},"recordType":{"type":"string","description":"记录类型","enum":["Sleep","Feeding","Diaper","Note"],"example":"Sleep"},"recordTimestamp":{"type":"string","description":"记录时间戳","example":"2025-05-02T10:30:00Z"},"details":{"type":"object","description":"记录详情"}},"required":["childId","recordType","recordTimestamp","details"]},"RecordResponseDto":{"type":"object","properties":{"id":{"type":"number","description":"记录ID","example":1},"childId":{"type":"number","description":"儿童ID","example":1},"recordType":{"type":"string","description":"记录类型","enum":["Sleep","Feeding","Diaper","Note"],"example":"Sleep"},"details":{"type":"object","description":"记录详情"},"recordTimestamp":{"format":"date-time","type":"string","description":"记录时间戳","example":"2025-05-02T10:30:00Z"},"createdAt":{"format":"date-time","type":"string","description":"记录创建时间","example":"2025-05-02T10:31:00Z"}},"required":["id","childId","recordType","details","recordTimestamp","createdAt"]},"UpdateRecordDto":{"type":"object","properties":{"childId":{"type":"number","description":"儿童ID","example":1},"recordType":{"type":"string","description":"记录类型","enum":["Sleep","Feeding","Diaper","Note"],"example":"Sleep"},"recordTimestamp":{"type":"string","description":"记录时间戳","example":"2025-05-02T10:30:00Z"},"details":{"type":"object","description":"记录详情","example":{"sleepDuration":"2h","quality":5,"environment":"安静的房间","notes":"睡前看了挖掘机"}}}},"ChatRequestDto":{"type":"object","properties":{"message":{"type":"string","description":"用户消息","example":"我的孩子最近睡眠不好，有什么建议吗？"},"childId":{"type":"number","description":"关联的孩子ID（可选）","example":1}},"required":["message"]},"ChatResponseDto":{"type":"object","properties":{"response":{"type":"string","description":"AI回复内容","example":"根据您提供的信息，我有以下建议..."},"chatId":{"type":"number","description":"聊天记录ID","example":123456789}},"required":["response","chatId"]},"CreateTextChunkDto":{"type":"object","properties":{"content":{"type":"string","description":"文本内容"},"sourceType":{"type":"string","description":"来源类型，如 child_profile, record, chat_history 等"},"sourceId":{"type":"number","description":"来源ID"},"childId":{"type":"number","description":"儿童ID"},"metadata":{"type":"object","description":"元数据，如时间戳、记录类型等","example":{"recordType":"sleep","timestamp":"2025-05-09T08:00:00Z"}}},"required":["content","sourceType","sourceId","childId"]},"CreateTextChunksDto":{"type":"object","properties":{"chunks":{"description":"文本块数组","type":"array","items":{"$ref":"#/components/schemas/CreateTextChunkDto"}}},"required":["chunks"]},"TextChunkFilterDto":{"type":"object","properties":{"sourceTypes":{"description":"来源类型数组","example":["child_profile","record"],"type":"array","items":{"type":"string"}},"fromDate":{"format":"date-time","type":"string","description":"开始日期"},"toDate":{"format":"date-time","type":"string","description":"结束日期"},"metadataFilters":{"type":"object","description":"元数据过滤条件","example":{"recordType":"sleep"}}}},"SearchTextChunkDto":{"type":"object","properties":{"queryText":{"type":"string","description":"查询文本"},"childId":{"type":"number","description":"儿童ID"},"limit":{"type":"number","description":"返回结果数量限制","default":5},"threshold":{"type":"number","description":"相似度阈值 (0-1)","default":0.7},"filters":{"description":"过滤条件","allOf":[{"$ref":"#/components/schemas/TextChunkFilterDto"}]}},"required":["queryText","childId"]},"TextChunkResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"文本块ID"},"content":{"type":"string","description":"文本内容"},"sourceType":{"type":"string","description":"来源类型"},"sourceId":{"type":"number","description":"来源ID"},"childId":{"type":"number","description":"儿童ID"},"metadata":{"type":"object","description":"元数据"},"createdAt":{"format":"date-time","type":"string","description":"创建时间"},"updatedAt":{"format":"date-time","type":"string","description":"更新时间"},"similarity":{"type":"number","description":"相似度分数 (0-1)"}},"required":["id","content","sourceType","sourceId","childId","metadata","createdAt","updatedAt"]},"UpdateTextChunkDto":{"type":"object","properties":{"content":{"type":"string","description":"新的文本内容"},"metadata":{"type":"object","description":"新的元数据"}},"required":["content"]},"ChatFeedbackDto":{"type":"object","properties":{"chatHistoryId":{"type":"number","description":"聊天历史ID","example":1},"isHelpful":{"type":"boolean","description":"反馈（true为有用，false为无用）","example":true}},"required":["chatHistoryId","isHelpful"]},"ChatStreamResponseDto":{"type":"object","properties":{"type":{"type":"string","description":"消息类型","example":"content","enum":["content","done","error"]},"content":{"type":"string","description":"AI回复内容片段","example":"根据您提供的信息"},"chatId":{"type":"number","description":"聊天记录ID，仅在type为done时返回","example":123456789},"error":{"type":"string","description":"错误信息，仅在type为error时返回","example":"处理请求时发生错误"}},"required":["type"]}}}}