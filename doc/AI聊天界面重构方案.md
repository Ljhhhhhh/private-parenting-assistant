# AI è‚²å„¿åŠ©æ‰‹èŠå¤©ç•Œé¢é‡æ„æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäº `assistant-ui` å’Œä¼šè¯ç®¡ç† APIï¼Œé‡æ„ç°æœ‰èŠå¤©ç•Œé¢ï¼Œæ‰“é€ ä¸€æµçš„ AI èŠå¤©äº¤äº’ä½“éªŒï¼Œæ”¯æŒå¤šä¼šè¯ç®¡ç†ã€æµç•…å®æ—¶å“åº”ç­‰ç°ä»£åŒ–èŠå¤©åŠŸèƒ½ã€‚

---

## ğŸ¯ è®¾è®¡ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡

- **ğŸš€ ä¸€æµäº¤äº’ä½“éªŒ**ï¼šè¾¾åˆ° ChatGPTã€Claude ç­‰é¡¶çº§ AI åŠ©æ‰‹çš„äº¤äº’æ°´å‡†
- **ğŸ“± ç§»åŠ¨ç«¯ä¼˜å…ˆ**ï¼šé’ˆå¯¹è‚²å„¿åœºæ™¯çš„ç§»åŠ¨ç«¯ä½¿ç”¨éœ€æ±‚ä¼˜åŒ–
- **ğŸ§  æ™ºèƒ½åŒ–ç¨‹åº¦**ï¼šä¾æ‰˜åç«¯æ™ºèƒ½åŠŸèƒ½ï¼Œå‰ç«¯ä¸“æ³¨ä½“éªŒä¼˜åŒ–
- **â™¿ æ— éšœç¢å‹å¥½**ï¼šæ”¯æŒå¿«æ·æ“ä½œã€å¤§å­—ä½“æ¨¡å¼
- **ğŸ¨ æ¸©é¦¨è®¾è®¡**ï¼šç¬¦åˆè‚²å„¿åŠ©æ‰‹çš„æ¸©æš–ã€äº²å’Œè®¾è®¡ç†å¿µ

### æŠ€æœ¯ç›®æ ‡

- **âš¡ é«˜æ€§èƒ½**ï¼šæµç•…çš„æµå¼å“åº”ã€å¿«é€Ÿçš„ç•Œé¢åˆ‡æ¢
- **ğŸ”„ å¯æ‰©å±•æ€§**ï¼šæ¨¡å—åŒ–æ¶æ„ã€æ˜“äºæ·»åŠ æ–°åŠŸèƒ½
- **ğŸ›¡ï¸ ç¨³å®šå¯é **ï¼šé”™è¯¯å¤„ç†ã€ç¦»çº¿æ”¯æŒã€æ•°æ®åŒæ­¥

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    èŠå¤©ç³»ç»Ÿæ¶æ„å›¾                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ä¼šè¯ç®¡ç†å±‚     â”‚  â”‚   æ¶ˆæ¯äº¤äº’å±‚     â”‚  â”‚  æ™ºèƒ½åŠŸèƒ½å±‚  â”‚  â”‚
â”‚  â”‚                â”‚  â”‚                â”‚  â”‚  (åç«¯å¤„ç†)  â”‚  â”‚
â”‚  â”‚ â€¢ ä¼šè¯åˆ—è¡¨      â”‚  â”‚ â€¢ æµå¼å“åº”      â”‚  â”‚ â€¢ æ™ºèƒ½å»ºè®®  â”‚  â”‚
â”‚  â”‚ â€¢ ä¼šè¯åˆ›å»º      â”‚  â”‚ â€¢ æ¶ˆæ¯æ¸²æŸ“      â”‚  â”‚ â€¢ ä¸Šä¸‹æ–‡æ„ŸçŸ¥ â”‚  â”‚
â”‚  â”‚ â€¢ ä¼šè¯åˆ‡æ¢      â”‚  â”‚ â€¢ ç¼–è¾‘é‡å‘      â”‚  â”‚ â€¢ åé¦ˆå­¦ä¹   â”‚  â”‚
â”‚  â”‚ â€¢ ä¼šè¯å½’æ¡£      â”‚  â”‚ â€¢ å†å²åŠ è½½      â”‚  â”‚ â€¢ ä¸ªæ€§åŒ–    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                     â”‚                â”‚        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                 Assistant-UI ç»„ä»¶å±‚                      â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  Thread    ThreadList    Composer    Message    ActionBar  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                     â”‚                â”‚        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    API æœåŠ¡å±‚                            â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  ä¼šè¯API    æ¶ˆæ¯API    å»ºè®®API    åé¦ˆAPI    å†å²API       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### 1. **ä¸»èŠå¤©å®¹å™¨ (ChatContainer)**

```typescript
interface ChatContainerProps {
  childId: number;
  initialConversationId?: number;
  mode: 'conversation' | 'single' | 'auto';
}
```

#### 2. **ä¼šè¯ç®¡ç†å™¨ (ConversationManager)**

```typescript
interface ConversationManagerProps {
  onConversationSelect: (id: number) => void;
  onNewConversation: () => void;
  currentChildId: number;
}
```

#### 3. **æ™ºèƒ½èŠå¤©ç•Œé¢ (SmartChatThread)**

```typescript
interface SmartChatThreadProps {
  conversationId?: number;
  childId: number;
}
```

---

## ğŸ¨ ç”¨æˆ·ç•Œé¢è®¾è®¡

### ç§»åŠ¨ç«¯å¸ƒå±€æ–¹æ¡ˆ

#### **ä¾§æ»‘å¼ä¼šè¯ç®¡ç†**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â˜°] æ™ºèƒ½é—®ç­”         [+] [âš™ï¸]   â”‚ â† é¡¶éƒ¨å¯¼èˆªæ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     æ¬¢è¿ç•Œé¢/æ¶ˆæ¯åˆ—è¡¨      â”‚   â”‚ â† ä¸»èŠå¤©åŒºåŸŸ
â”‚  â”‚                         â”‚   â”‚
â”‚  â”‚  [æ™ºèƒ½å»ºè®®å¡ç‰‡...]       â”‚   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â”‚  ğŸ’¬ å®å®ç¡çœ é—®é¢˜         â”‚   â”‚
â”‚  â”‚  ğŸ¤– æ ¹æ®æ‚¨çš„æè¿°...      â”‚   â”‚
â”‚  â”‚      ğŸ‘ ğŸ‘              â”‚   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [è¾“å…¥æ¡†...]           [å‘é€] â”‚ â† è¾“å…¥åŒºåŸŸ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¾§æ»‘ä¼šè¯åˆ—è¡¨ï¼ˆå·¦æ»‘å‘¼å‡ºï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ ä¼šè¯åˆ—è¡¨  â”‚
â”‚             â”‚
â”‚ + æ–°å»ºä¼šè¯   â”‚
â”‚             â”‚
â”‚ ğŸ’¤ ä»Šæ—¥ç¡çœ   â”‚
â”‚ ğŸ¼ å–‚å…»è®°å½•  â”‚
â”‚ ğŸ“ˆ æˆé•¿å’¨è¯¢  â”‚
â”‚ ...        â”‚
â”‚             â”‚
â”‚ ğŸ—‚ï¸ å·²å½’æ¡£   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾è®¡è§„èŒƒåº”ç”¨

åŸºäºé¡¹ç›®è®¾è®¡è§„èŒƒï¼ŒèŠå¤©ç•Œé¢é‡‡ç”¨ï¼š

#### **è‰²å½©æ–¹æ¡ˆ**

- **ä¸»è‰²è°ƒ**ï¼šæ¸©æš–èœœæ¡ƒ #FFB38Aï¼ˆç”¨æˆ·æ¶ˆæ¯æ°”æ³¡ã€å‘é€æŒ‰é’®ï¼‰
  - æ·±è‰²å˜ä½“ï¼š#FF9F73ï¼ˆæ‚¬åœ/ç‚¹å‡»çŠ¶æ€ï¼‰
  - æµ…è‰²å˜ä½“ï¼š#FFC9A8ï¼ˆè£…é¥°å…ƒç´ ï¼‰
- **è¾…åŠ©è‰²**ï¼šæŸ”å’Œç²‰ #F8BBD0ï¼ˆè£…é¥°å…ƒç´ ã€å¼ºè°ƒå†…å®¹ï¼‰
- **å¼ºè°ƒè‰²**ï¼šæ´»åŠ›é»„ #FFDA63ï¼ˆé‡è¦æé†’ã€æˆå°±æ ‡è¯†ï¼‰
- **èƒŒæ™¯è‰²**ï¼š#FDFBF8ï¼ˆé¡µé¢èƒŒæ™¯ - ææµ…æš–ç™½ï¼‰
- **AI å›å¤èƒŒæ™¯**ï¼š#FDFBF8ï¼ˆä¸é¡µé¢èƒŒæ™¯ä¸€è‡´ï¼Œè¥é€ æ¸©é¦¨æ„Ÿï¼‰
- **åŠŸèƒ½è‰²**ï¼š
  - æˆåŠŸè‰²ï¼š#66BB6Aï¼ˆåé¦ˆæŒ‰é’®"æœ‰å¸®åŠ©"ï¼‰
  - é”™è¯¯è‰²ï¼š#EF5350ï¼ˆåé¦ˆæŒ‰é’®"æ— å¸®åŠ©"ï¼‰
  - ä¿¡æ¯è‰²ï¼š#56C0E0ï¼ˆç³»ç»Ÿæç¤ºï¼‰

#### **æ’ç‰ˆè§„èŒƒ**

- **æ¶ˆæ¯æ­£æ–‡**ï¼š16pxï¼Œè¡Œé«˜ 1.5ï¼Œé¢œè‰² #333333
- **æ—¶é—´æˆ³**ï¼š12pxï¼Œé¢œè‰² #999999
- **ä¼šè¯æ ‡é¢˜**ï¼š18pxï¼Œå­—é‡ 500ï¼Œé¢œè‰² #333333
- **æ¬¢è¿æ ‡é¢˜**ï¼š24pxï¼Œè¡Œé«˜ 1.33ï¼Œå­—é‡ 600ï¼Œé¢œè‰² #333333
- **å»ºè®®å¡ç‰‡æ–‡å­—**ï¼š14pxï¼Œè¡Œé«˜ 1.43ï¼Œé¢œè‰² #333333
- **è¾“å…¥æ¡†å ä½ç¬¦**ï¼š16pxï¼Œé¢œè‰² #999999
- **å¯¼èˆªæ æ ‡é¢˜**ï¼š20pxï¼Œå­—é‡ 500ï¼Œé¢œè‰² #333333

#### **ç»„ä»¶æ ·å¼**

##### **æ¶ˆæ¯æ°”æ³¡**

- **ç”¨æˆ·æ¶ˆæ¯**ï¼š

  - èƒŒæ™¯ï¼šæ¸©æš–èœœæ¡ƒæ¸å˜ `from-[#FFB38A] to-[#FFC9A8]`
  - æ–‡å­—ï¼šç™½è‰² #FFFFFF
  - åœ†è§’ï¼š12pxï¼ˆç¬¦åˆè®¾è®¡è§„èŒƒï¼‰
  - å³ä¸Šè§’å°åœ†è§’ï¼š4pxï¼ˆåˆ›é€ å°¾å·´æ•ˆæœï¼‰
  - é˜´å½±ï¼š0px 2px 8px rgba(255, 179, 138, 0.15)

- **AI æ¶ˆæ¯**ï¼š
  - èƒŒæ™¯ï¼š#FDFBF8ï¼ˆä¸é¡µé¢èƒŒæ™¯ä¸€è‡´ï¼‰
  - è¾¹æ¡†ï¼š1px solid #E0E0E0
  - æ–‡å­—ï¼š#333333
  - åœ†è§’ï¼š12px
  - å·¦ä¸Šè§’å°åœ†è§’ï¼š4px
  - é˜´å½±ï¼š0px 2px 8px rgba(0, 0, 0, 0.08)

##### **æŒ‰é’®ç»„ä»¶**

- **å‘é€æŒ‰é’®**ï¼š

  - èƒŒæ™¯ï¼šæ¸©æš–èœœæ¡ƒæ¸å˜ `from-[#FFB38A] to-[#FFC9A8]`
  - å°ºå¯¸ï¼š48px Ã— 48pxï¼ˆåœ†å½¢ï¼‰
  - å›¾æ ‡ï¼šç™½è‰²ï¼Œ20px
  - é˜´å½±ï¼š0px 4px 12px rgba(255, 179, 138, 0.25)
  - æ‚¬åœçŠ¶æ€ï¼šæ·±è‰²å˜ä½“ #FF9F73ï¼Œå¢å¼ºé˜´å½±

- **åé¦ˆæŒ‰é’®**ï¼š
  - é«˜åº¦ï¼š32px
  - åœ†è§’ï¼šå®Œå…¨åœ†è§’ `rounded-full`
  - å†…è¾¹è·ï¼šæ°´å¹³ 12pxï¼Œå‚ç›´ 6px
  - æœ‰å¸®åŠ©ï¼š
    - é»˜è®¤ï¼šè¾¹æ¡† #E0E0E0ï¼Œæ–‡å­— #999999
    - é€‰ä¸­ï¼šèƒŒæ™¯ #66BB6A/20ï¼Œæ–‡å­— #66BB6Aï¼Œè¾¹æ¡† #66BB6A
  - æ— å¸®åŠ©ï¼š
    - é»˜è®¤ï¼šè¾¹æ¡† #E0E0E0ï¼Œæ–‡å­— #999999
    - é€‰ä¸­ï¼šèƒŒæ™¯ #EF5350/20ï¼Œæ–‡å­— #EF5350ï¼Œè¾¹æ¡† #EF5350

##### **è¾“å…¥æ¡†ç»„ä»¶**

- **å¤–è§‚**ï¼šåœ†è§’çŸ©å½¢ï¼ˆ8px åœ†è§’ï¼Œç¬¦åˆè®¾è®¡è§„èŒƒï¼‰
- **å°ºå¯¸**ï¼šé«˜åº¦ 48pxï¼Œå®½åº¦ 100%
- **å†…è¾¹è·**ï¼šæ°´å¹³ 16pxï¼Œå‚ç›´ 12px
- **èƒŒæ™¯**ï¼šç™½è‰² #FFFFFF
- **è¾¹æ¡†**ï¼š
  - é»˜è®¤ï¼š#E0E0E0
  - èšç„¦ï¼šæ¸©æš–èœœæ¡ƒè‰² #FFB38A
- **å ä½ç¬¦**ï¼š#999999

##### **å¡ç‰‡ç»„ä»¶**

- **ä¿¡æ¯å¡ç‰‡**ï¼š

  - åœ†è§’ï¼š16pxï¼ˆç¬¦åˆè®¾è®¡è§„èŒƒï¼‰
  - èƒŒæ™¯ï¼šç™½è‰² #FFFFFF
  - é˜´å½±ï¼š0px 2px 8px rgba(0, 0, 0, 0.08)
  - å†…è¾¹è·ï¼š16px

- **å»ºè®®å¡ç‰‡**ï¼š

  - åœ†è§’ï¼š16px
  - èƒŒæ™¯ï¼šç™½è‰² #FFFFFF
  - è¾¹æ¡†ï¼š1px solid #FFE5D6ï¼ˆæµ…èœœæ¡ƒè‰²è¾¹æ¡†ï¼‰
  - é˜´å½±ï¼š0px 2px 8px rgba(255, 179, 138, 0.1)
  - å†…è¾¹è·ï¼š16px
  - æ‚¬åœçŠ¶æ€ï¼šæµ…èœœæ¡ƒèƒŒæ™¯ #FFF8F5ï¼Œè¾¹æ¡†å˜ä¸ºä¸»è‰² #FFB38A

- **ä¼šè¯åˆ—è¡¨é¡¹**ï¼š
  - é«˜åº¦ï¼š64pxï¼ˆç¬¦åˆè®¾è®¡è§„èŒƒï¼‰
  - åœ†è§’ï¼š12px
  - èƒŒæ™¯ï¼šç™½è‰² #FFFFFF
  - å†…è¾¹è·ï¼šæ°´å¹³ 16px
  - æ‚¬åœçŠ¶æ€ï¼šææµ…èœœæ¡ƒèƒŒæ™¯ #FFF8F5
  - é€‰ä¸­çŠ¶æ€ï¼šæµ…èœœæ¡ƒèƒŒæ™¯ #FFB38A/10ï¼Œå·¦ä¾§èœœæ¡ƒè‰²æŒ‡ç¤ºæ¡

##### **å¯¼èˆªæ ç»„ä»¶**

- **é¡¶éƒ¨å¯¼èˆªæ **ï¼š
  - èƒŒæ™¯ï¼šç™½è‰² #FFFFFF
  - é«˜åº¦ï¼š56px + å®‰å…¨åŒºåŸŸ
  - åº•éƒ¨é˜´å½±ï¼š0px 1px 3px rgba(0, 0, 0, 0.05)
  - æ ‡é¢˜ï¼š20pxï¼Œå­—é‡ 500ï¼Œé¢œè‰² #333333
  - å›¾æ ‡ï¼šèœœæ¡ƒè‰² #FFB38A

##### **æ¬¢è¿ç•Œé¢ç»„ä»¶**

- **æ¬¢è¿å›¾æ ‡**ï¼š

  - å°ºå¯¸ï¼š120px Ã— 120px
  - é¢œè‰²ï¼šæ¸©æš–èœœæ¡ƒè‰² #FFB38A
  - æµ®åŠ¨åŠ¨ç”»ï¼šä¸Šä¸‹è½»å¾®æµ®åŠ¨

- **æ¬¢è¿æ–‡å­—**ï¼š
  - ä¸»æ ‡é¢˜ï¼š24pxï¼Œå­—é‡ 600ï¼Œé¢œè‰² #333333
  - å‰¯æ ‡é¢˜ï¼š16pxï¼Œé¢œè‰² #666666

### åŠ¨æ•ˆä¸å¾®äº¤äº’

#### **æ¶ˆæ¯åŠ¨æ•ˆ**

- **æ¶ˆæ¯æ¸å…¥**ï¼š
  ```css
  @keyframes messageSlideIn {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  .message-animation {
    animation: messageSlideIn 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  }
  ```

#### **æŒ‰é’®åé¦ˆ**

- **å‘é€æŒ‰é’®**ï¼š
  - ç‚¹å‡»æ—¶è½»å¾®ç¼©æ”¾ï¼š`active:scale-95`
  - æ—‹è½¬å›¾æ ‡ï¼šå‘é€æ—¶å›¾æ ‡æ—‹è½¬æ•ˆæœ
  - è¿‡æ¸¡æ—¶é—´ï¼š150ms

#### **å»ºè®®å¡ç‰‡**

- **æ‚¬åœæ•ˆæœ**ï¼š
  - è½»å¾®ä¸Šç§»ï¼š`hover:-translate-y-1`
  - é˜´å½±å¢å¼ºï¼š`hover:shadow-lg`
  - è¿‡æ¸¡æ—¶é—´ï¼š200ms

#### **ä¼šè¯åˆ‡æ¢**

- **ä¾§æ»‘åŠ¨ç”»**ï¼š
  - è¿›å…¥ï¼šä»å·¦ä¾§æ»‘å…¥ï¼Œ300ms
  - é€€å‡ºï¼šå‘å·¦ä¾§æ»‘å‡ºï¼Œ250ms
  - ç¼“åŠ¨å‡½æ•°ï¼š`cubic-bezier(0.25, 0.8, 0.25, 1)`

### å“åº”å¼é€‚é…

#### **ç§»åŠ¨ç«¯ä¼˜åŒ–**

- **è§¦æ‘¸åŒºåŸŸ**ï¼šæ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ æœ€å° 44px Ã— 44px
- **å®‰å…¨åŒºåŸŸ**ï¼š
  ```css
  .chat-container {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  ```

#### **é”®ç›˜é€‚é…**

- **è¾“å…¥åŒºåŸŸ**ï¼š
  - å›ºå®šåœ¨åº•éƒ¨ï¼Œæ”¯æŒé”®ç›˜æ¨èµ·
  - æœ€å°å®‰å…¨è·ç¦»ï¼š`max(env(safe-area-inset-bottom), 16px)`

#### **æ¨ªå±é€‚é…**

- **æ¶ˆæ¯åŒºåŸŸ**ï¼šæœ€å¤§å®½åº¦ 600pxï¼Œå±…ä¸­æ˜¾ç¤º
- **ä¾§è¾¹æ **ï¼šå›ºå®šæ˜¾ç¤ºï¼Œä¸è¦†ç›–ä¸»å†…å®¹åŒºåŸŸ

### æ— éšœç¢è®¾è®¡

#### **è‰²å½©å¯¹æ¯”åº¦**

- **æ–‡æœ¬å¯¹æ¯”åº¦**ï¼šç¡®ä¿æ‰€æœ‰æ–‡æœ¬ç¬¦åˆ WCAG 2.1 AA æ ‡å‡†
  - ä¸»è¦æ–‡æœ¬ (#333333) vs èƒŒæ™¯ (#FDFBF8)ï¼šå¯¹æ¯”åº¦ > 7:1
  - æ¬¡è¦æ–‡æœ¬ (#666666) vs èƒŒæ™¯ (#FDFBF8)ï¼šå¯¹æ¯”åº¦ > 5:1
  - ç™½è‰²æ–‡å­— vs èœœæ¡ƒèƒŒæ™¯ (#FFB38A)ï¼šå¯¹æ¯”åº¦ > 4.5:1

#### **ç„¦ç‚¹çŠ¶æ€**

- **å¯è§æ€§**ï¼šæ¸…æ™°çš„ç„¦ç‚¹æŒ‡ç¤ºå™¨
- **é¢œè‰²**ï¼šèœœæ¡ƒè‰²å¤–æè¾¹ `outline-2 outline-[#FFB38A]`
- **åç§»**ï¼š2px åç§»ç¡®ä¿å¯è§æ€§

#### **è¯­ä¹‰åŒ–æ ‡è®°**

- **è§’è‰²æ ‡è¯†**ï¼š`role="main"`ã€`role="complementary"`
- **ARIA æ ‡ç­¾**ï¼š`aria-label`ã€`aria-describedby`
- **é”®ç›˜å¯¼èˆª**ï¼šTab é”®é¡ºåºåˆç†

---

## ğŸ› ï¸ æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### æŠ€æœ¯æ ˆé€‰æ‹©

#### **æ ¸å¿ƒæŠ€æœ¯**

- **UI æ¡†æ¶**ï¼šassistant-ui + shadcn/ui
- **çŠ¶æ€ç®¡ç†**ï¼šZustandï¼ˆå·²æœ‰çš„ children store æ¨¡å¼ï¼‰
- **è·¯ç”±ç®¡ç†**ï¼šReact Routerï¼ˆæ”¯æŒä¼šè¯ ID è·¯ç”±ï¼‰
- **æ ·å¼æ–¹æ¡ˆ**ï¼šTailwind CSS + CSS å˜é‡
- **å›¾æ ‡åº“**ï¼š@iconify/reactï¼ˆå·²é›†æˆï¼‰

#### **ç‰¹æ®ŠåŠŸèƒ½**

- **æµå¼å“åº”**ï¼šServer-Sent Events
- **ç¦»çº¿æ”¯æŒ**ï¼šIndexedDB + Service Worker
- **æ‰‹åŠ¿æ“ä½œ**ï¼šFramer Motion

### æ•°æ®æµè®¾è®¡

#### **ä¼šè¯çŠ¶æ€ç®¡ç†**

```typescript
interface ConversationStore {
  // çŠ¶æ€
  conversations: ConversationResponseDto[];
  currentConversationId: number | null;
  isLoading: boolean;

  // æ“ä½œ
  createConversation: (data: CreateConversationDto) => Promise<void>;
  loadConversations: (childId: number) => Promise<void>;
  selectConversation: (id: number) => void;
  updateConversation: (
    id: number,
    data: UpdateConversationDto,
  ) => Promise<void>;
  archiveConversation: (id: number) => Promise<void>;
  deleteConversation: (id: number) => Promise<void>;
}
```

#### **æ¶ˆæ¯çŠ¶æ€ç®¡ç†**

```typescript
interface MessageStore {
  // çŠ¶æ€
  messagesByConversation: Record<number, ChatHistoryDto[]>;
  streamingMessage: string | null;
  isStreaming: boolean;

  // æ“ä½œ
  loadMessages: (conversationId: number) => Promise<void>;
  sendMessage: (conversationId: number, message: string) => Promise<void>;
  sendStreamMessage: (conversationId: number, message: string) => void;
  provideFeedback: (messageId: number, isHelpful: boolean) => Promise<void>;
}
```

### ç»„ä»¶æ¶æ„è®¾è®¡

#### **1. é¡µé¢çº§ç»„ä»¶**

**SmartChatPage.tsx**

```typescript
export const SmartChatPage: FC = () => {
  const { currentChild } = useChildrenStore();
  const [currentMode, setCurrentMode] = useState<ChatMode>('auto');

  return (
    <div className="flex h-screen bg-[#FDFBF8]">
      {/* ä¾§è¾¹æ ï¼ˆæ¡Œé¢ç«¯ï¼‰æˆ–æŠ½å±‰ï¼ˆç§»åŠ¨ç«¯ï¼‰ */}
      <ConversationSidebar />

      {/* ä¸»èŠå¤©åŒºåŸŸ */}
      <ChatContainer childId={currentChild?.id} mode={currentMode} />
    </div>
  );
};
```

#### **2. å®¹å™¨çº§ç»„ä»¶**

**ChatContainer.tsx**

```typescript
export const ChatContainer: FC<ChatContainerProps> = ({
  childId,
  mode = 'auto',
}) => {
  const [conversationId, setConversationId] = useState<number | null>(null);

  return (
    <div className="flex-1 flex flex-col">
      {/* é¡¶éƒ¨å¯¼èˆªæ  */}
      <ChatHeader
        conversationId={conversationId}
        onModeChange={setCurrentMode}
      />

      {/* Assistant-UI Thread */}
      <SmartChatThread conversationId={conversationId} childId={childId} />
    </div>
  );
};
```

#### **3. æ™ºèƒ½åŒ–ç»„ä»¶**

**SmartChatThread.tsx**

```typescript
export const SmartChatThread: FC<SmartChatThreadProps> = ({
  conversationId,
  childId,
}) => {
  // é›†æˆassistant-uiçš„Threadç»„ä»¶
  // æ™ºèƒ½å»ºè®®ç”±åç«¯APIæä¾›

  return (
    <AssistantProvider runtime={chatRuntime}>
      <Thread
        components={{
          ThreadWelcome: SmartWelcome,
          UserMessage: EnhancedUserMessage,
          AssistantMessage: EnhancedAssistantMessage,
          Composer: SmartComposer,
        }}
      />
    </AssistantProvider>
  );
};
```

### Assistant-UI é›†æˆæ–¹æ¡ˆ

#### **Runtime é…ç½®**

```typescript
const createChatRuntime = (conversationId: number | null, childId: number) => {
  return createAISDKAdapter({
    async sendMessage(message: string) {
      if (conversationId) {
        // ä¼šè¯æ¨¡å¼ï¼šåœ¨æŒ‡å®šä¼šè¯ä¸­å‘é€æ¶ˆæ¯
        return sendConversationMessageStream(conversationId, message);
      } else {
        // å•æ¬¡æ¨¡å¼ï¼šä¼ ç»ŸèŠå¤©
        return chat({ message, childId });
      }
    },

    async loadMessages() {
      if (conversationId) {
        return getConversationMessages(conversationId);
      }
      return [];
    },
  });
};
```

#### **è‡ªå®šä¹‰ç»„ä»¶**

**SmartWelcome.tsx**

```typescript
export const SmartWelcome: FC = () => {
  const { currentChild } = useChildrenStore();
  const { suggestions } = useChatSuggestions(currentChild?.id);

  return (
    <ThreadPrimitive.Empty>
      <div className="flex flex-col items-center justify-center p-8 min-h-[60vh]">
        {/* æ¸©é¦¨æ¬¢è¿æ’å›¾ - ç¬¦åˆè®¾è®¡è§„èŒƒ */}
        <div className="w-32 h-32 mb-8 flex items-center justify-center text-[#FFB38A] animate-float">
          <Icon icon="ph:baby-fill" width={120} height={120} />
        </div>

        {/* ä¸ªæ€§åŒ–æ¬¢è¿æ–‡å­— */}
        <div className="text-center mb-8">
          <h2 className="text-2xl font-semibold text-[#333333] mb-2">
            {currentChild?.nickname
              ? `${currentChild.nickname}çš„ä¸“å±è‚²å„¿åŠ©æ‰‹`
              : 'æ‚¨çš„ä¸“å±è‚²å„¿åŠ©æ‰‹'}
          </h2>
          <p className="text-base text-[#666666]">
            æœ‰ä»€ä¹ˆè‚²å„¿é—®é¢˜ï¼Œè¯·éšæ—¶å‘æˆ‘æé—®
          </p>
        </div>

        {/* æ™ºèƒ½å»ºè®®å¡ç‰‡ï¼ˆæ¥è‡ªåç«¯APIï¼‰ */}
        <SuggestionCards suggestions={suggestions} />
      </div>
    </ThreadPrimitive.Empty>
  );
};

// å»ºè®®å¡ç‰‡ç»„ä»¶
const SuggestionCards: FC<{ suggestions: string[] }> = ({ suggestions }) => {
  return (
    <div className="w-full max-w-md">
      <h3 className="text-sm font-medium text-[#666666] mb-4 text-center">
        æ¨èé—®é¢˜
      </h3>
      <div className="space-y-3">
        {suggestions.slice(0, 4).map((suggestion, index) => (
          <SuggestionCard key={index} suggestion={suggestion} />
        ))}
      </div>
    </div>
  );
};

// å•ä¸ªå»ºè®®å¡ç‰‡
const SuggestionCard: FC<{ suggestion: string }> = ({ suggestion }) => {
  const { append } = useAssistant();

  const handleClick = () => {
    append({ role: 'user', content: suggestion });
  };

  return (
    <button
      onClick={handleClick}
      className="w-full p-4 bg-white border border-[#FFE5D6] rounded-2xl 
                 text-left text-sm text-[#333333] transition-all duration-200
                 hover:bg-[#FFF8F5] hover:border-[#FFB38A] hover:-translate-y-0.5 
                 hover:shadow-lg hover:shadow-[#FFB38A]/10
                 active:scale-98"
    >
      <div className="flex items-start space-x-3">
        <div className="flex-shrink-0 w-6 h-6 mt-0.5 text-[#FFB38A]">
          <Icon icon="ph:chat-circle-dots" width={20} height={20} />
        </div>
        <span className="flex-1 leading-relaxed">{suggestion}</span>
      </div>
    </button>
  );
};
```

**SmartComposer.tsx**

```typescript
export const SmartComposer: FC = () => {
  const [isComposing, setIsComposing] = useState(false);

  return (
    <ComposerPrimitive.Root className="border-t border-[#E0E0E0] bg-white p-4 shadow-[0_-2px_10px_rgba(0,0,0,0.03)]">
      <div className="flex items-end space-x-3 max-w-4xl mx-auto">
        {/* è¾“å…¥æ¡†å®¹å™¨ */}
        <div className="flex-1 relative">
          <ComposerPrimitive.Input
            className="w-full min-h-[48px] max-h-32 py-3 px-4 
                       bg-white border border-[#E0E0E0] rounded-lg 
                       text-base text-[#333333] placeholder-[#999999]
                       focus:outline-none focus:border-[#FFB38A] focus:ring-1 focus:ring-[#FFB38A]/20
                       resize-none transition-all duration-200"
            placeholder="è¯·æè¿°å®å®çš„æƒ…å†µ..."
            onFocus={() => setIsComposing(true)}
            onBlur={() => setIsComposing(false)}
          />

          {/* è¾“å…¥çŠ¶æ€æŒ‡ç¤ºå™¨ */}
          {isComposing && (
            <div
              className="absolute -top-1 left-4 px-2 py-1 bg-[#FFB38A] text-white text-xs rounded-full
                           transform -translate-y-full opacity-80"
            >
              æ­£åœ¨è¾“å…¥...
            </div>
          )}
        </div>

        {/* å‘é€æŒ‰é’® */}
        <ComposerPrimitive.Send asChild>
          <SmartSendButton />
        </ComposerPrimitive.Send>
      </div>
    </ComposerPrimitive.Root>
  );
};

// æ™ºèƒ½å‘é€æŒ‰é’®
const SmartSendButton: FC = () => {
  const { isRunning } = useAssistant();

  return (
    <button
      className={cn(
        'flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center',
        'transition-all duration-200 shadow-lg relative overflow-hidden group',
        'min-w-[44px] min-h-[44px]', // ç¡®ä¿è§¦æ‘¸åŒºåŸŸè¶³å¤Ÿå¤§
        isRunning
          ? 'bg-[#E0E0E0] cursor-not-allowed'
          : 'bg-gradient-to-r from-[#FFB38A] to-[#FFC9A8] hover:from-[#FF9F73] hover:to-[#FFB38A] active:scale-95 shadow-[#FFB38A]/25',
      )}
      disabled={isRunning}
    >
      {/* èƒŒæ™¯å…‰æ•ˆ */}
      {!isRunning && (
        <div className="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity duration-300" />
      )}

      {/* å‘é€å›¾æ ‡ */}
      <div
        className={cn(
          'relative z-10 text-white transition-transform duration-300',
          isRunning ? 'animate-spin' : 'group-hover:rotate-12',
        )}
      >
        {isRunning ? (
          <Icon icon="ph:circle-notch" width={20} height={20} />
        ) : (
          <Icon icon="ph:paper-plane-right-fill" width={20} height={20} />
        )}
      </div>
    </button>
  );
};
```

**EnhancedUserMessage.tsx**

```typescript
export const EnhancedUserMessage: FC = () => {
  return (
    <MessagePrimitive.Root className="flex justify-end mb-6 animate-fadeIn">
      <div className="max-w-[80%] relative group">
        {/* æ¶ˆæ¯æ°”æ³¡ */}
        <div
          className="bg-gradient-to-r from-[#FFB38A] to-[#FFC9A8] 
                        text-white rounded-xl rounded-tr-sm p-4 
                        shadow-lg shadow-[#FFB38A]/15 relative"
        >
          <MessagePrimitive.Content className="text-[15px] leading-relaxed" />

          {/* æ¶ˆæ¯å°¾å·´ */}
          <div
            className="absolute top-0 right-[-8px] w-0 h-0 
                          border-t-[8px] border-t-[#FFB38A] 
                          border-r-[8px] border-r-transparent"
          />
        </div>

        {/* æ—¶é—´æˆ³ */}
        <MessagePrimitive.InProgress className="text-xs text-[#999999] mt-1 text-right mr-1">
          <Icon
            icon="ph:clock"
            width={12}
            height={12}
            className="inline mr-1"
          />
          <span>å‘é€ä¸­...</span>
        </MessagePrimitive.InProgress>

        <div className="text-xs text-[#999999] mt-1 text-right mr-1 opacity-0 group-hover:opacity-100 transition-opacity">
          åˆšåˆš
        </div>
      </div>
    </MessagePrimitive.Root>
  );
};
```

**EnhancedAssistantMessage.tsx**

```typescript
export const EnhancedAssistantMessage: FC = () => {
  const [feedback, setFeedback] = useState<'helpful' | 'not-helpful' | null>(
    null,
  );
  const { handleFeedback } = useFeedbackHandler();

  const onFeedback = (isHelpful: boolean) => {
    const feedbackType = isHelpful ? 'helpful' : 'not-helpful';
    setFeedback(feedbackType);
    handleFeedback(message.id, isHelpful);
  };

  return (
    <MessagePrimitive.Root className="flex justify-start mb-6 animate-fadeIn">
      <div className="max-w-[85%] relative group">
        {/* AI å¤´åƒ */}
        <div className="flex items-start space-x-3">
          <div
            className="flex-shrink-0 w-8 h-8 bg-gradient-to-r from-[#FFB38A] to-[#FFC9A8] 
                          rounded-full flex items-center justify-center"
          >
            <Icon
              icon="ph:robot-fill"
              width={16}
              height={16}
              className="text-white"
            />
          </div>

          <div className="flex-1">
            {/* æ¶ˆæ¯æ°”æ³¡ */}
            <div
              className="bg-[#FDFBF8] border border-[#E0E0E0] 
                            text-[#333333] rounded-xl rounded-tl-sm p-4 
                            shadow-sm relative"
            >
              <MessagePrimitive.Content className="text-[15px] leading-relaxed prose prose-sm max-w-none" />

              {/* æ¶ˆæ¯å°¾å·´ */}
              <div
                className="absolute top-0 left-[-8px] w-0 h-0 
                              border-t-[8px] border-t-[#E0E0E0] 
                              border-l-[8px] border-l-transparent"
              />

              {/* åé¦ˆæŒ‰é’® */}
              <MessagePrimitive.If hasContent>
                <div className="mt-3 pt-3 border-t border-[#F0F0F0] flex justify-end space-x-2">
                  <FeedbackButton
                    type="helpful"
                    isActive={feedback === 'helpful'}
                    onClick={() => onFeedback(true)}
                  />
                  <FeedbackButton
                    type="not-helpful"
                    isActive={feedback === 'not-helpful'}
                    onClick={() => onFeedback(false)}
                  />
                </div>
              </MessagePrimitive.If>
            </div>

            {/* æ—¶é—´æˆ³ */}
            <div className="text-xs text-[#999999] mt-1 ml-1 opacity-0 group-hover:opacity-100 transition-opacity">
              åˆšåˆš
            </div>
          </div>
        </div>
      </div>
    </MessagePrimitive.Root>
  );
};

// åé¦ˆæŒ‰é’®ç»„ä»¶
const FeedbackButton: FC<{
  type: 'helpful' | 'not-helpful';
  isActive: boolean;
  onClick: () => void;
}> = ({ type, isActive, onClick }) => {
  const isHelpful = type === 'helpful';

  return (
    <button
      onClick={onClick}
      className={cn(
        'text-xs px-3 py-1.5 rounded-full transition-all duration-200 min-w-[44px] min-h-[32px]',
        'flex items-center justify-center space-x-1',
        isActive
          ? isHelpful
            ? 'bg-[#66BB6A]/20 text-[#66BB6A] border border-[#66BB6A]'
            : 'bg-[#EF5350]/20 text-[#EF5350] border border-[#EF5350]'
          : 'text-[#999999] border border-[#E0E0E0] hover:bg-[#F5F5F5]',
      )}
    >
      <Icon
        icon={isHelpful ? 'ph:thumbs-up' : 'ph:thumbs-down'}
        width={14}
        height={14}
      />
      <span>{isHelpful ? 'æœ‰å¸®åŠ©' : 'æ— å¸®åŠ©'}</span>
    </button>
  );
};
```

---

## ğŸ§  æ™ºèƒ½åŒ–åŠŸèƒ½è®¾è®¡

### æ™ºèƒ½å»ºè®®ç³»ç»Ÿ

#### **ç®€åŒ–çš„å»ºè®®è·å–**

```typescript
interface SmartSuggestion {
  id: string;
  text: string;
  category: 'feeding' | 'sleep' | 'growth' | 'health' | 'behavior';
}

// æ™ºèƒ½å»ºè®®å®Œå…¨ç”±åç«¯APIæä¾›
const useChatSuggestions = (childId: number) => {
  return useQuery({
    queryKey: ['suggestions', childId],
    queryFn: () => getChatSuggestions(childId),
    enabled: !!childId,
  });
};
```

### åé¦ˆç³»ç»Ÿ

#### **ç”¨æˆ·åé¦ˆæ”¶é›†**

```typescript
const useFeedbackHandler = () => {
  const handleFeedback = useCallback(
    async (messageId: number, isHelpful: boolean) => {
      try {
        await provideChatFeedback({
          chatHistoryId: messageId,
          isHelpful,
        });

        // æ›´æ–°UIçŠ¶æ€
        showFeedbackSuccess();
      } catch (error) {
        console.error('å‘é€åé¦ˆå¤±è´¥:', error);
        showFeedbackError();
      }
    },
    [],
  );

  return { handleFeedback };
};
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ

### æ¸²æŸ“ä¼˜åŒ–

#### **è™šæ‹Ÿæ»šåŠ¨å®ç°**

```typescript
const VirtualMessageList: FC<VirtualMessageListProps> = ({ messages }) => {
  const { virtualItems, totalSize, scrollElementRef } = useVirtualizer({
    count: messages.length,
    getScrollElement: () => scrollElementRef.current,
    estimateSize: (index) => estimateMessageHeight(messages[index]),
    overscan: 5,
  });

  return (
    <div ref={scrollElementRef} className="message-list-container">
      <div style={{ height: totalSize }}>
        {virtualItems.map((virtualRow) => (
          <MessageItem
            key={virtualRow.key}
            message={messages[virtualRow.index]}
            style={{
              position: 'absolute',
              top: virtualRow.start,
              height: virtualRow.size,
            }}
          />
        ))}
      </div>
    </div>
  );
};
```

#### **æ¶ˆæ¯æ‡’åŠ è½½**

```typescript
const useInfiniteMessages = (conversationId: number) => {
  return useInfiniteQuery({
    queryKey: ['messages', conversationId],
    queryFn: ({ pageParam = 0 }) =>
      getConversationMessages(conversationId, {
        limit: 20,
        offset: pageParam,
      }),
    getNextPageParam: (lastPage, allPages) =>
      lastPage.length === 20 ? allPages.length * 20 : undefined,
  });
};
```

### ç½‘ç»œä¼˜åŒ–

#### **æ™ºèƒ½é¢„åŠ è½½**

```typescript
const useSmartPreloading = (childId: number) => {
  useEffect(() => {
    // é¢„åŠ è½½æœ€è¿‘çš„ä¼šè¯åˆ—è¡¨
    queryClient.prefetchQuery(['conversations', childId], () =>
      getConversations({ childId, limit: 10 }),
    );

    // é¢„åŠ è½½æ™ºèƒ½å»ºè®®
    queryClient.prefetchQuery(['suggestions', childId], () =>
      getChatSuggestions(childId),
    );
  }, [childId]);
};
```

#### **ç¦»çº¿æ”¯æŒ**

```typescript
const useOfflineSupport = () => {
  const [isOnline, setIsOnline] = useState(navigator.onLine);

  useEffect(() => {
    // ç›‘å¬ç½‘ç»œçŠ¶æ€
    const handleOnline = () => setIsOnline(true);
    const handleOffline = () => setIsOnline(false);

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  // ç¦»çº¿æ—¶çš„æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†
  const queueMessage = useCallback(
    (message: string) => {
      if (!isOnline) {
        // å­˜å‚¨åˆ° IndexedDB
        storeOfflineMessage(message);
        // æ˜¾ç¤ºç¦»çº¿æç¤º
        showOfflineNotification();
      }
    },
    [isOnline],
  );

  return { isOnline, queueMessage };
};
```

---

## ğŸ›ï¸ åŸºç¡€åŠŸèƒ½è®¾è®¡

### å¿«æ·æ“ä½œ

```typescript
const useQuickActions = () => {
  const quickActions = [
    {
      id: 'fever',
      icon: 'ğŸŒ¡ï¸',
      label: 'å‘çƒ§å¤„ç†',
      prompt: 'å®å®å‘çƒ§äº†ï¼Œä½“æ¸©38.5åº¦ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ',
      urgent: true,
    },
    {
      id: 'crying',
      icon: 'ğŸ˜­',
      label: 'å“­é—¹å®‰æŠš',
      prompt: 'å®å®ä¸€ç›´å“­é—¹ä¸åœï¼Œå°è¯•äº†å„ç§æ–¹æ³•éƒ½ä¸è¡Œ',
      urgent: false,
    },
    {
      id: 'feeding',
      icon: 'ğŸ¼',
      label: 'å–‚å…»é—®é¢˜',
      prompt: 'å…³äºå®å®çš„å–‚å…»ï¼Œæˆ‘æƒ³å’¨è¯¢ä¸€ä¸‹',
      urgent: false,
    },
  ];

  return { quickActions };
};
```

---

## ğŸ“± ç§»åŠ¨ç«¯ç‰¹ä¼˜åŒ–

### æ‰‹åŠ¿äº¤äº’

#### **æ»‘åŠ¨æ“ä½œ**

```typescript
const useSwipeGestures = () => {
  const swipeHandlers = useSwipeable({
    onSwipedLeft: () => {
      // å·¦æ»‘ï¼šæ‰“å¼€ä¼šè¯åˆ—è¡¨
      openConversationSidebar();
    },
    onSwipedRight: () => {
      // å³æ»‘ï¼šå…³é—­ä¾§è¾¹æ æˆ–è¿”å›
      closeConversationSidebar();
    },
    onSwipedUp: () => {
      // ä¸Šæ»‘ï¼šå¿«é€Ÿæ»šåŠ¨åˆ°é¡¶éƒ¨
      scrollToTop();
    },
    onSwipedDown: () => {
      // ä¸‹æ»‘ï¼šåˆ·æ–°å½“å‰ä¼šè¯
      refreshCurrentConversation();
    },
    preventDefaultTouchmoveEvent: true,
    trackMouse: true,
  });

  return swipeHandlers;
};
```

#### **é•¿æŒ‰èœå•**

```typescript
const useLongPressMenu = () => {
  const longPressHandlers = useLongPress(
    (event) => {
      // æ˜¾ç¤ºä¸Šä¸‹æ–‡èœå•
      showContextMenu(event.target, [
        { label: 'å¤åˆ¶', action: () => copyMessage() },
        { label: 'é‡æ–°ç”Ÿæˆ', action: () => regenerateResponse() },
        { label: 'åˆ†äº«', action: () => shareMessage() },
        { label: 'æ”¶è—', action: () => bookmarkMessage() },
      ]);
    },
    {
      threshold: 500, // 500ms è§¦å‘é•¿æŒ‰
      captureEvent: true,
    },
  );

  return longPressHandlers;
};
```

### é€‚é…ä¼˜åŒ–

#### **å®‰å…¨åŒºåŸŸé€‚é…**

```css
.chat-container {
  /* iOS åˆ˜æµ·å±é€‚é… */
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

.input-area {
  /* è™šæ‹Ÿé”®ç›˜é€‚é… */
  padding-bottom: max(env(safe-area-inset-bottom), 16px);
}
```

#### **è§¦æ‘¸ä¼˜åŒ–**

```typescript
const TouchOptimizedButton: FC<TouchOptimizedButtonProps> = ({
  children,
  ...props
}) => {
  return (
    <button
      {...props}
      className={cn(
        // æœ€å°è§¦æ‘¸é¢ç§¯ 44x44px
        'min-h-[44px] min-w-[44px]',
        // è§¦æ‘¸åé¦ˆ
        'active:scale-95 transition-transform',
        // é˜²æ­¢åŒå‡»ç¼©æ”¾
        'touch-manipulation',
        props.className,
      )}
      style={{
        // é˜²æ­¢iOSæŒ‰é’®é«˜äº®
        WebkitTapHighlightColor: 'transparent',
        ...props.style,
      }}
    >
      {children}
    </button>
  );
};
```

---

## ğŸ”§ å¼€å‘å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šåŸºç¡€æ¶æ„ (1-2 å‘¨)

#### **Week 1: æ ¸å¿ƒç»„ä»¶å¼€å‘**

- [ ] åˆ›å»ºåŸºç¡€é¡µé¢ç»„ä»¶ç»“æ„
- [ ] é›†æˆ assistant-ui åŸºç¡€ç»„ä»¶
- [ ] å®ç°ä¼šè¯çŠ¶æ€ç®¡ç† (Zustand store)
- [ ] é…ç½®è·¯ç”±ç³»ç»Ÿæ”¯æŒä¼šè¯ ID

#### **Week 2: API é›†æˆ**

- [ ] å®ç°ä¼šè¯ç®¡ç† API è°ƒç”¨
- [ ] é›†æˆæµå¼æ¶ˆæ¯å“åº”
- [ ] å®ŒæˆåŸºç¡€çš„æ¶ˆæ¯å‘é€/æ¥æ”¶åŠŸèƒ½
- [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œ loading çŠ¶æ€

### é˜¶æ®µäºŒï¼šç”¨æˆ·ä½“éªŒä¼˜åŒ– (2-3 å‘¨)

#### **Week 3: æ™ºèƒ½å»ºè®®ç³»ç»Ÿ**

- [ ] é›†æˆåç«¯æ™ºèƒ½å»ºè®® API
- [ ] å¼€å‘å»ºè®®å¡ç‰‡ç»„ä»¶
- [ ] æ·»åŠ å»ºè®®ç‚¹å‡»å’Œè‡ªåŠ¨å‘é€
- [ ] å®ç°åé¦ˆæ”¶é›†åŠŸèƒ½

#### **Week 4: ä¼šè¯ç®¡ç†**

- [ ] å®ç°ä¼šè¯åˆ—è¡¨ç•Œé¢
- [ ] æ·»åŠ ä¾§æ»‘ä¼šè¯åˆ‡æ¢
- [ ] å®Œæˆä¼šè¯åˆ›å»ºã€åˆ é™¤ã€å½’æ¡£
- [ ] å®ç°ä¼šè¯æ ‡é¢˜æ™ºèƒ½ç”Ÿæˆ

#### **Week 5: ç§»åŠ¨ç«¯ä¼˜åŒ–**

- [ ] å®ç°æ‰‹åŠ¿æ§åˆ¶
- [ ] æ·»åŠ å¿«æ·æ“ä½œé¢æ¿
- [ ] å®Œå–„ç§»åŠ¨ç«¯é€‚é…
- [ ] ä¼˜åŒ–è§¦æ‘¸äº¤äº’ä½“éªŒ

### é˜¶æ®µä¸‰ï¼šæ€§èƒ½å’Œå®Œå–„ (1-2 å‘¨)

#### **Week 6: æ€§èƒ½ä¼˜åŒ–**

- [ ] å®ç°è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–
- [ ] æ·»åŠ ç¦»çº¿æ”¯æŒ
- [ ] å®Œå–„åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ
- [ ] è¿›è¡Œå…¨é¢çš„ç§»åŠ¨ç«¯æµ‹è¯•

#### **Week 7: æµ‹è¯•å’Œå‘å¸ƒ**

- [ ] ç”¨æˆ·ä½“éªŒæµ‹è¯•å’Œä¼˜åŒ–
- [ ] æ€§èƒ½è°ƒä¼˜å’Œ bug ä¿®å¤
- [ ] æ–‡æ¡£å®Œå–„
- [ ] å‡†å¤‡å‘å¸ƒ

---

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

### ç”¨æˆ·ä½“éªŒæŒ‡æ ‡

- **å“åº”é€Ÿåº¦**ï¼šæ¶ˆæ¯å‘é€åˆ°é¦–å­—å›å¤ < 500ms
- **ç•Œé¢æµç•…åº¦**ï¼š60fps æ»šåŠ¨æ€§èƒ½
- **æ“ä½œæ•ˆç‡**ï¼šæ–°å»ºä¼šè¯å¹¶å‘é€æ¶ˆæ¯ < 3 æ­¥æ“ä½œ
- **é”™è¯¯ç‡**ï¼šæ¶ˆæ¯å‘é€å¤±è´¥ç‡ < 1%

### åŠŸèƒ½å®Œæˆåº¦

- **ä¼šè¯ç®¡ç†**ï¼š100% API åŠŸèƒ½è¦†ç›–
- **æ™ºèƒ½å»ºè®®**ï¼šåç«¯ API å®Œå…¨é›†æˆ
- **ç§»åŠ¨ç«¯é€‚é…**ï¼šä¸»æµè®¾å¤‡å®Œå…¨é€‚é…
- **æ— éšœç¢æ”¯æŒ**ï¼šWCAG 2.1 AA çº§åˆ«åˆè§„

### æŠ€æœ¯æŒ‡æ ‡

- **Bundle å¤§å°**ï¼šå¢é‡ < 150KB (gzip)
- **å†…å­˜ä½¿ç”¨**ï¼šé•¿æ—¶é—´ä½¿ç”¨ < 80MB
- **ç¦»çº¿æ”¯æŒ**ï¼šåŸºç¡€åŠŸèƒ½ç¦»çº¿å¯ç”¨
- **å…¼å®¹æ€§**ï¼šiOS 12+, Android 8+

---

## ğŸ¯ æ€»ç»“

æœ¬æ–¹æ¡ˆåŸºäº `assistant-ui` æ„å»ºä¸€æµçš„ AI èŠå¤©ä½“éªŒï¼Œä¸¥æ ¼éµå¾ªé¡¹ç›®è®¾è®¡è§„èŒƒï¼Œé‡ç‚¹å…³æ³¨ï¼š

### æ ¸å¿ƒä»·å€¼

1. **ğŸš€ æè‡´æ€§èƒ½**ï¼šæµå¼å“åº”ã€è™šæ‹Ÿæ»šåŠ¨ã€æ™ºèƒ½é¢„åŠ è½½
2. **ğŸ§  åç«¯æ™ºèƒ½**ï¼šä¾æ‰˜åç«¯ API æä¾›æ™ºèƒ½å»ºè®®å’Œä¸ªæ€§åŒ–æœåŠ¡
3. **ğŸ“± ç§»åŠ¨ä¼˜å…ˆ**ï¼šæ‰‹åŠ¿äº¤äº’ã€å®Œç¾é€‚é…ã€æµç•…ä½“éªŒ
4. **â™¿ æ— éšœç¢**ï¼šå¤§å­—ä½“ã€å¿«æ·æ“ä½œã€æ¸…æ™°åé¦ˆ
5. **ğŸ¨ æ¸©é¦¨ä½“éªŒ**ï¼šä¸¥æ ¼éµå¾ªæ¸©æš–èœœæ¡ƒè‰²ç³»è®¾è®¡è§„èŒƒï¼Œè¥é€ æ¸©é¦¨è‚²å„¿ç¯å¢ƒ

### è®¾è®¡äº®ç‚¹

- **è‰²å½©å’Œè°ç»Ÿä¸€**ï¼š

  - ä¸»è‰²è°ƒé‡‡ç”¨æ¸©æš–èœœæ¡ƒ #FFB38Aï¼Œä¸é¡¹ç›®æ•´ä½“é£æ ¼å®Œå…¨ä¸€è‡´
  - ç”¨æˆ·æ¶ˆæ¯ä½¿ç”¨èœœæ¡ƒæ¸å˜èƒŒæ™¯ï¼ŒAI å›å¤ä½¿ç”¨æ¸©é¦¨æš–ç™½èƒŒæ™¯ #FDFBF8
  - åŠŸèƒ½è‰²å½©ä¸¥æ ¼éµå¾ªè®¾è®¡è§„èŒƒï¼Œç¡®ä¿è§†è§‰ä¸€è‡´æ€§

- **ç»„ä»¶è§„èŒƒåŒ–**ï¼š

  - åœ†è§’ç»Ÿä¸€ï¼šæ¶ˆæ¯æ°”æ³¡ 12pxï¼Œå¡ç‰‡ 16pxï¼Œè¾“å…¥æ¡† 8px
  - é—´è·ç³»ç»Ÿï¼šä¸¥æ ¼éµå¾ª 8px åŸºç¡€æ …æ ¼ç³»ç»Ÿ
  - é˜´å½±æ•ˆæœï¼šç»Ÿä¸€ä½¿ç”¨é¡¹ç›®æ ‡å‡†é˜´å½± rgba(0, 0, 0, 0.08)

- **äº¤äº’ä½“éªŒä¼˜åŒ–**ï¼š
  - è§¦æ‘¸åŒºåŸŸæœ€å° 44px Ã— 44pxï¼Œç¡®ä¿ç§»åŠ¨ç«¯æ“ä½œä¾¿åˆ©
  - åé¦ˆåŠ¨æ•ˆç»Ÿä¸€ï¼ŒæŒ‰é’®ç‚¹å‡»ã€å¡ç‰‡æ‚¬åœç­‰éµå¾ª 300ms è¿‡æ¸¡æ—¶é—´
  - è‰²å½©å¯¹æ¯”åº¦ç¬¦åˆ WCAG 2.1 AA æ ‡å‡†

### æŠ€æœ¯äº®ç‚¹

- **æ¸è¿›å¼å¢å¼º**ï¼šä»å•æ¬¡èŠå¤©å¹³æ»‘å‡çº§åˆ°ä¼šè¯ç®¡ç†
- **ç»„ä»¶åŒ–æ¶æ„**ï¼šåŸºäº assistant-ui çš„ä¸“ä¸šèŠå¤©ç»„ä»¶
- **åç«¯æ™ºèƒ½**ï¼šæ™ºèƒ½åŠŸèƒ½ç”±åç«¯å¤„ç†ï¼Œå‰ç«¯ä¸“æ³¨ä½“éªŒ
- **æ€§èƒ½ä¼˜åŒ–**ï¼šè™šæ‹Ÿæ»šåŠ¨ã€æ‡’åŠ è½½ã€ç¦»çº¿æ”¯æŒ
- **è®¾è®¡ç³»ç»Ÿ**ï¼šå®Œå…¨èå…¥é¡¹ç›®è®¾è®¡è§„èŒƒï¼Œä¿æŒå“ç‰Œä¸€è‡´æ€§

### å®æ–½ä¿éšœ

- **åˆ†é˜¶æ®µäº¤ä»˜**ï¼šç¡®ä¿æ¯ä¸ªç‰ˆæœ¬éƒ½èƒ½ç‹¬ç«‹è¿è¡Œ
- **å‘ä¸‹å…¼å®¹**ï¼šä¿æŒç°æœ‰åŠŸèƒ½çš„ç¨³å®šæ€§
- **å¯æµ‹è¯•æ€§**ï¼šå®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œ E2E æµ‹è¯•
- **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„å’Œæ–‡æ¡£
- **è®¾è®¡ä¸€è‡´æ€§**ï¼šä¸¥æ ¼éµå¾ªè®¾è®¡è§„èŒƒï¼Œç¡®ä¿ä¸é¡¹ç›®æ•´ä½“é£æ ¼å’Œè°ç»Ÿä¸€

### é¢„æœŸæ•ˆæœ

é€šè¿‡è¿™ä¸ªæ–¹æ¡ˆï¼Œæˆ‘ä»¬å°†æ‰“é€ å‡ºï¼š

- **è§†è§‰ç»Ÿä¸€**ï¼šä¸é¡¹ç›®ç™»å½•ã€æ³¨å†Œã€å„¿ç«¥ä¿¡æ¯ç­‰é¡µé¢ä¿æŒå®Œç¾çš„è®¾è®¡ä¸€è‡´æ€§
- **ä½“éªŒæµç•…**ï¼šåª²ç¾é¡¶çº§ AI åŠ©æ‰‹çš„èŠå¤©äº¤äº’ä½“éªŒ
- **åŠŸèƒ½å®Œæ•´**ï¼šå®Œæ•´çš„ä¼šè¯ç®¡ç†ã€æ™ºèƒ½å»ºè®®ã€åé¦ˆæ”¶é›†ç­‰åŠŸèƒ½
- **ç§»åŠ¨å‹å¥½**ï¼šå®Œç¾é€‚é…ç§»åŠ¨ç«¯ä½¿ç”¨åœºæ™¯ï¼Œæ”¯æŒæ‰‹åŠ¿æ“ä½œ
- **æ¸©é¦¨è´´å¿ƒ**ï¼šæ·±åº¦å¥‘åˆè‚²å„¿åŠ©æ‰‹çš„ä½¿ç”¨åœºæ™¯å’Œæƒ…æ„Ÿéœ€æ±‚

æœ€ç»ˆå®ç°ä¸€ä¸ªæ—¢ä¸“ä¸šåˆæ¸©é¦¨ã€æ—¢æ™ºèƒ½åˆæ˜“ç”¨çš„ AI è‚²å„¿å’¨è¯¢ç•Œé¢ï¼Œä¸ºæ–°æ‰‹çˆ¶æ¯æä¾›è´´å¿ƒã€å¯é çš„è‚²å„¿æ”¯æŒæœåŠ¡ã€‚
